<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymelead.org/extras/spring-security">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Propiedades</title>
        <link rel="icon" href="/img/home_243.ico" type="image/x-icon" />
        <link rel="stylesheet" href="/css/formulariodos.css" />
        <link rel="stylesheet" href="/css/index.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    </head>

    <body>
        <div th:replace="/fragments/casa" :: div></div>
        <nav th:replace="/fragments/navbar" :: nav> </nav>
        <h2 class="titulo" style="text-align: center">Lista de Propiedades</h2>


        <div class="contenedorInput" style="text-align: center">
            <form th:action="@{/propiedad/listarPropiedades}">

                <select name="keyword" id="keyword" class="coolinput" th:value="${keyword}" style="width: 200px">
                    <option value="" disiable selected>Tipo de Vivienda</option>
                    <option value="CASA">Casa</option>
                    <option value="CASA_QUINTA">Casa Quinta</option>
                    <option value="COCHERA">Cochera</option>
                    <option value="DEPTO">Departamento</option>
                    <option value="GALPON">Galpon</option>
                    <option value="PH">Propiedad Horizontal</option>
                    <option value="TERRENO">Terreno</option>
                </select>

                <select name="keyword1" id="keyword1" class="coolinput" th:value="${keyword1}" style="width: 200px">
                    <option value="" disiable selected>Estado de la Vivienda</option>
                    <option value="VENTA">Venta</option>
                    <option value="ALQUILER">Alquiler</option>
                    <option value="ALQUILER_TEMPORARIO">Alquiler temporario</option>
                    <option value="PERMUTA">Permuta</option>
                    <option value="OTROS">Otros</option>
                </select>

                <select name="keyword2" id="keyword2" class="coolinput" th:value="${keyword2}" style="width: 200px">
                    <option value="" disiable selected>Moneda</option>
                    <option value="Dolares">Dolares</option>
                    <option value="Pesos">Pesos</option>
                </select> 
                <input name="keyword3" id="keyword3" class="coolinput" placeholder="Localidad 🔍" th:value="${keyword3}" style="width: 200px; text-align: end">
                    <input name="keyword4" id="keyword4" class="coolinput" placeholder="Precio 🔍" th:value="${keyword4}" style="width: 200px; text-align: end">
                        <input name="keyword5" id="keyword5" class="coolinput" placeholder="Mts² Totales 🔍" th:value="${keyword4}" style="width: 200px; text-align: end">

                            <br>
                                <div class="divBoton" style="margin-top: 10px; text-align: center; margin-bottom: 10px">
                                    <button type="submit" class="btn-success" style="width: 100px; height: 30px; color: white;
                                            border-radius: 10px"><b>Buscar</b></button>
                                    <button onclick="limpiar()" class="btn-dark" style="width: 100px; height: 30px; background-color: black; color: white;
                                            border-radius: 10px"><b>Limpiar</b></button>
                                </div>
                                </form>
                                </div>

                                <div class="container" style="border-color: red">
                                    <div class="row row-cols-3 row-cols-md-3 g-3">
                                        <div th:each="propiedades : ${propiedades}" class="col">
                                            <div style="background-color: lightblue; border-radius: 10px;">
                                                <h5 th:text="${propiedades.tipoVivienda}" style="text-align: center"></h5>
                                                <p th:text="${propiedades.estado}" style="text-align: center"></p>
                                                <div class="card mb-3"
                                                     style="width: 400px; height: 100px; background-color: bisque; margin-left: 10px; border-color: black;">
                                                    <div class="row g-0" style="display: inline-flex">
                                                        <div class="col-md-6">
                                                            <div id="imageCarousel" class="carousel slide" data-bs-ride="carousel">
                                                                <div id="carouselExample" class="carousel slide" data-bs-ride="carousel"
                                                                     data-bs-interval="3000">

                                                                    <div class="carousel-inner" style="border-radius: 5%">
                                                                        <div th:each="imagenesPorPropiedad, iterStat : ${imagenesPorPropiedad[propiedades.idPropiedad]}"
                                                                             th:class="${iterStat.index == 0} ? 'carousel-item active' : 'carousel-item'">
                                                                            <img style="width: 200px; height: 100px"
                                                                                 th:src="'data:image/jpeg;base64,' + ${#strings.toString(imagenesPorPropiedad)}"
                                                                                 alt="Imagen">
                                                                        </div>
                                                                        <a class="carousel-control-prev" href="#carouselExample" role="button"
                                                                           data-bs-slide="prev">
                                                                            <span class="carousel-control-prev-icon" aria-hidden="true"
                                                                                  ></span>
                                                                            <span class="visually-hidden">Anterior</span>
                                                                        </a>
                                                                        <a class="carousel-control-next" href="#carouselExample" role="button"
                                                                           data-bs-slide="next">
                                                                            <span class="carousel-control-next-icon" aria-hidden="true"
                                                                                  ></span>
                                                                            <span class="visually-hidden">Siguiente</span>
                                                                        </a>
                                                                    </div>
                                                                    <button class="carousel-control-prev" type="button"
                                                                            data-bs-target="#imageCarousel" data-bs-slide="prev">
                                                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                                        <span class="visually-hidden">Previous</span>
                                                                    </button>
                                                                    <button class="carousel-control-next" type="button"
                                                                            data-bs-target="#imageCarousel" data-bs-slide="next">
                                                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                                        <span class="visually-hidden">Next</span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <h5 style="margin-left: 10px; margin-bottom: 0; ">
                                                                <strong th:text="${propiedades.mts2Totales}"></strong>
                                                                <span style="color: red;"> Mts² Totales</span>
                                                            </h5>

                                                            <p th:text="'Localidad: '+${propiedades.localidad}"
                                                               style="margin-left: 10px; margin-bottom: 0; font-style: italic"></p>
                                                            <p th:text="'Moneda: '+${propiedades.moneda}" style="margin-left: 10px; margin-bottom: 0">
                                                            </p>
                                                            <p th:text="'Precio: '+${propiedades.precioPropiedad}"
                                                               style="margin-left: 10px; margin-bottom: 0"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div style="margin-left: 150px; margin-top: 0px; margin-bottom: 5px">
                                                    <a th:href="@{/imagen/propiedad/__${propiedades.idPropiedad}__}" class="btn btn-success">Detalle
                                                        Propiedad</a>
                                                </div>
                                                <br>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div id="successPopup" class="popup">
                                    <div th:if="${error != null}" class="card1">
                                        <div class="card_image"> <img src="/img/sadDog.jpg" /> </div>
                                        <div class="card_title title-white">
                                            <h5 style="color: red">** ERROR **</h5>
                                            <h5 th:text="${error}"></h5>
                                        </div>
                                    </div>
                                </div>
                                <div id="errorPopup" class="popup">
                                    <div th:if="${exito != null}" class="card1">
                                        <div class="card_image"> <img src="/img/perrofeliz.jpg" /> </div>
                                        <div class="card_title title-white">
                                            <h5>** EXITO **</h5>
                                            <p th:text="${exito}"></p>
                                        </div>
                                    </div>
                                </div>

                                <!--        <script>
                                    // Variables para almacenar la selección del usuario
                                            var seleccionGuardada = null;
                                
                                    // Función para guardar la selección actual
                                            function guardarSeleccion() {
                                                var select = document.getElementById("keyword");
                                                seleccionGuardada = select.value;
                                            }
                                
                                    // Función para restaurar la selección guardada
                                            function restaurarSeleccion() {
                                                var select = document.getElementById("keyword");
                                                if (seleccionGuardada) {
                                                    select.value = seleccionGuardada;
                                                }
                                            }
                                        </script>-->

                                <script>
                                    function limpiar() {
                                        document.getElementById("keyword").value = "";
                                        document.getElementById("keyword1").value = "";
                                        document.getElementById("keyword2").value = "";
                                        document.getElementById("keyword3").value = "";
                                        document.getElementById("keyword4").value = "";
                                        document.getElementById("keyword5").value = "";
                                    }
                                </script>

                                <script>
                                    function showSuccessPopup() {
                                        var successPopup = document.getElementById("successPopup");
                                        successPopup.style.display = "block";

                                        // Ocultar el popup después de 5 segundos
                                        setTimeout(function () {
                                            successPopup.style.display = "none";
                                        }, 5000);
                                    }

                                    // Función para mostrar el popup de error
                                    function showErrorPopup() {
                                        var errorPopup = document.getElementById("errorPopup");
                                        errorPopup.style.display = "block";

                                        // Ocultar el popup después de 5 segundos
                                        setTimeout(function () {
                                            errorPopup.style.display = "none";
                                        }, 5000);
                                    }

                                    // Ejemplo de uso: Mostrar popup de éxito después de un evento exitoso
                                    showSuccessPopup();

                                    // Ejemplo de uso: Mostrar popup de error después de un evento fallido
                                    showErrorPopup();
                                </script>
                                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
                                        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
                                crossorigin="anonymous"></script>
                                </body>


                                </html>